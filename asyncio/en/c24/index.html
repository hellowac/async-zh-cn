
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="hellowac-异步编程资料">
      
      
      
      
        <link rel="prev" href="../c23/">
      
      
        <link rel="next" href="../c25/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.4">
    
    
      
        <title>24. Python Asyncio 常见问题 - async异步编程</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.bd3936ea.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="blue">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#24-python-asyncio-常见问题" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
你当前浏览的版本已不是最新版本，
<a href="../../../..">
    <strong>点击这里</strong>
</a>查看最新版本的文档

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../.." title="async异步编程" class="md-header__button md-logo" aria-label="async异步编程" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            async异步编程
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              24. Python Asyncio 常见问题
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/hellowac/async-zh-cn" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    hellowac/async-zh-cn
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../.." class="md-tabs__link">
          
  
    
  
  概览

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
    
  
  完整指南

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../runner/" class="md-tabs__link">
          
  
    
  
  其他

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="async异步编程" class="md-nav__button md-logo" aria-label="async异步编程" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    async异步编程
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/hellowac/async-zh-cn" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    hellowac/async-zh-cn
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    
    
      
        
          
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../.." class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    概览
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            概览
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    完整指南
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            完整指南
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../c1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. 什么是异步编程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../c2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Asyncio 是什么
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../c3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Asyncio 在什么时候使用
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../c4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Python 中的协程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../c5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. 定义、创建和运行协程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../c6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. 事件循环是什么
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../c7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7. Asyncio 任务的创建和运行
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../c8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    8. 使用和查询任务
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../c9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    9. 当前正在运行的任务
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../c10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    10. 同时运行多个协程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../c11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    11. 在Group中管理多个协程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../c12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    12. 等待任务的集合
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../c13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    13. 等待有时间限制的协程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../c14/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    14. 防止任务被取消
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../c15/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    15. 在 Asyncio 中运行阻塞任务
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../c16/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    16. 异步迭代器
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../c17/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    17. 异步生成器
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../c18/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    18. 异步上下文管理器
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../c19/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    19. 异步推导式
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../c20/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    20. 在非阻塞子进程中运行命令
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../c21/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    21. 非阻塞流
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../c22/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    22. 检查网站状态的示例
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../c23/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    23. Python Asyncio 常见错误
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    24. Python Asyncio 常见问题
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    24. Python Asyncio 常见问题
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#241-如何停止任务" class="md-nav__link">
    24.1 如何停止任务？
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#242-如何等待任务完成" class="md-nav__link">
    24.2 如何等待任务完成？
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#243-如何获取任务的返回值" class="md-nav__link">
    24.3 如何获取任务的返回值？
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#244-如何在后台运行任务" class="md-nav__link">
    24.4 如何在后台运行任务？
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#245-如何等待所有后台任务" class="md-nav__link">
    24.5 如何等待所有后台任务？
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#246-正在运行的任务是否会阻止事件循环退出" class="md-nav__link">
    24.6 正在运行的任务是否会阻止事件循环退出？
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#247-如何显示运行任务的进度" class="md-nav__link">
    24.7 如何显示运行任务的进度？
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#248-如何在延迟后运行任务" class="md-nav__link">
    24.8 如何在延迟后运行任务？
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#249-如何运行后续任务" class="md-nav__link">
    24.9 如何运行后续任务？
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2410-如何在-asyncio-中执行阻塞-io-或-cpu-密集型函数" class="md-nav__link">
    24.10 如何在 Asyncio 中执行阻塞 I/O 或 CPU 密集型函数？
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../c25/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    25. 使用 Asyncio 的常见反对意见
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../c26/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    26. 进一步阅读
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../c27/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    27. 结论
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    其他
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            其他
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../runner/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    如何使用async.Runner执行多个协程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../task_group/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    如何使用 asyncio.TaskGroup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../cheat_sheet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Asyncio 表达式及API备忘录
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../api_mind_map/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    asyncio API 思维导图
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#241-如何停止任务" class="md-nav__link">
    24.1 如何停止任务？
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#242-如何等待任务完成" class="md-nav__link">
    24.2 如何等待任务完成？
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#243-如何获取任务的返回值" class="md-nav__link">
    24.3 如何获取任务的返回值？
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#244-如何在后台运行任务" class="md-nav__link">
    24.4 如何在后台运行任务？
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#245-如何等待所有后台任务" class="md-nav__link">
    24.5 如何等待所有后台任务？
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#246-正在运行的任务是否会阻止事件循环退出" class="md-nav__link">
    24.6 正在运行的任务是否会阻止事件循环退出？
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#247-如何显示运行任务的进度" class="md-nav__link">
    24.7 如何显示运行任务的进度？
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#248-如何在延迟后运行任务" class="md-nav__link">
    24.8 如何在延迟后运行任务？
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#249-如何运行后续任务" class="md-nav__link">
    24.9 如何运行后续任务？
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2410-如何在-asyncio-中执行阻塞-io-或-cpu-密集型函数" class="md-nav__link">
    24.10 如何在 Asyncio 中执行阻塞 I/O 或 CPU 密集型函数？
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="24-python-asyncio-常见问题">24. Python Asyncio 常见问题<a class="headerlink" href="#24-python-asyncio-常见问题" title="Permanent link">&para;</a></h1>
<p><strong>24. Python Asyncio Common Questions</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">中文</label><label for="__tabbed_1_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>本节回答开发人员在 Python 中使用 <strong>asyncio</strong> 时提出的常见问题。</p>
<p><strong>您对 asyncio 有疑问吗?</strong></p>
<p>在下面的评论中提出您的问题，我会尽力回答它，也许会将其添加到这个问题列表中。</p>
</div>
<div class="tabbed-block">
<p>This section answers common questions asked by developers when using asyncio in Python.</p>
<p><strong>Do you have a question about asyncio?</strong></p>
<p>Ask your question in the comments below and I will do my best to answer it and perhaps add it to this list of questions.</p>
</div>
</div>
</div>
<h2 id="241-如何停止任务">24.1 如何停止任务？<a class="headerlink" href="#241-如何停止任务" title="Permanent link">&para;</a></h2>
<p><strong>24.1 How to Stop a Task?</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">中文</label><label for="__tabbed_2_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>我们可以通过 <a href="https://docs.python.org/3/library/asyncio-task.html#asyncio.Task.cancel">asyncio.Task</a> 对象上的 <strong>cancel()</strong> 方法取消任务。</p>
<p>如果任务被取消，则 <strong>cancel()</strong> 方法返回 <code>True</code>，否则返回 <code>False</code>。</p>
<p>例如:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># 取消任务</span>
was_cancelled <span style="color: #666666">=</span> task<span style="color: #666666">.</span>cancel()
</code></pre></div>
<p>如果任务已经完成，则无法取消，<strong>cancel()</strong> 方法将返回 <code>False</code>，任务不会处于已取消状态。</p>
<p>下次任务有机会运行时，它将引发 <strong>CancelledError</strong> 异常。</p>
<p>如果未在包装的协程内处理 <strong>CancelledError</strong> 异常，则任务将被取消。</p>
<p>否则，如果在包装的协程内处理 <strong>CancelledError</strong> 异常，则任务将不会被取消。</p>
<p><strong>cancel()</strong> 方法同样还可以传递一个消息参数，作为 <strong>CancelledError</strong> 异常的内容。</p>
<p>我们可以探讨如何取消正在运行的任务。</p>
<p>在这个例子中，我们定义了一个任务协程，它报告一条消息，然后阻塞一会儿。</p>
<p>然后，我们定义用作 <strong>asyncio</strong> 程序入口点的主协程。 它报告一条消息，创建并安排任务，然后等待片刻。</p>
<p>然后，主协程在任务运行时恢复并取消任务。 它会再等待一段时间，以便任务响应取消请求。 然后主协程报告取消任务的请求是否成功。</p>
<p>任务被取消，然后完成。</p>
<p>然后主协程在关闭程序之前报告任务的状态是否已取消。</p>
<p>下面列出了完整的示例。</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #3D7B7B; font-style: italic"># SuperFastPython.com</span>
<span style="color: #3D7B7B; font-style: italic"># 取消一个正在运行的任务的例子</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">asyncio</span>

<span style="color: #3D7B7B; font-style: italic"># 为任务定义一个协程</span>
<span style="color: #008000; font-weight: bold">async</span> <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">task_coroutine</span>():
    <span style="color: #3D7B7B; font-style: italic"># 报告一条消息</span>
    <span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;executing the task&#39;</span>)
    <span style="color: #3D7B7B; font-style: italic"># 阻塞片刻</span>
    <span style="color: #008000; font-weight: bold">await</span> asyncio<span style="color: #666666">.</span>sleep(<span style="color: #666666">1</span>)

<span style="color: #3D7B7B; font-style: italic"># 自定义协程</span>
<span style="color: #008000; font-weight: bold">async</span> <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">main</span>():
    <span style="color: #3D7B7B; font-style: italic"># 报告一条消息</span>
    <span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;main coroutine started&#39;</span>)
    <span style="color: #3D7B7B; font-style: italic"># 创建并调度任务</span>
    task <span style="color: #666666">=</span> asyncio<span style="color: #666666">.</span>create_task(task_coroutine())
    <span style="color: #3D7B7B; font-style: italic"># 等待一下</span>
    <span style="color: #008000; font-weight: bold">await</span> asyncio<span style="color: #666666">.</span>sleep(<span style="color: #666666">0.1</span>)
    <span style="color: #3D7B7B; font-style: italic"># 取消任务</span>
    was_cancelled <span style="color: #666666">=</span> task<span style="color: #666666">.</span>cancel()
    <span style="color: #3D7B7B; font-style: italic"># 报告取消请求是否成功</span>
    <span style="color: #008000">print</span>(<span style="color: #BA2121">f&#39;was canceled: </span><span style="color: #A45A77; font-weight: bold">{</span>was_cancelled<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&#39;</span>)
    <span style="color: #3D7B7B; font-style: italic"># 等待一下</span>
    <span style="color: #008000; font-weight: bold">await</span> asyncio<span style="color: #666666">.</span>sleep(<span style="color: #666666">0.1</span>)
    <span style="color: #3D7B7B; font-style: italic"># 检查任务的状态</span>
    <span style="color: #008000">print</span>(<span style="color: #BA2121">f&#39;canceled: </span><span style="color: #A45A77; font-weight: bold">{</span>task<span style="color: #666666">.</span>cancelled()<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&#39;</span>)
    <span style="color: #3D7B7B; font-style: italic"># 报告最后的消息</span>
    <span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;main coroutine done&#39;</span>)

<span style="color: #3D7B7B; font-style: italic"># 启动异步程序</span>
asyncio<span style="color: #666666">.</span>run(main())
</code></pre></div>
<p>运行该示例将启动 <strong>asyncio</strong> 事件循环并执行 <strong>main()</strong> 协程。</p>
<p><strong>main()</strong> 协程报告一条消息，然后创建并调度任务协程。</p>
<p>然后它会挂起并等待一段时间以允许任务协程开始运行。</p>
<p>该任务运行，报告消息并休眠一段时间。</p>
<p><strong>main()</strong> 协程恢复并取消任务。 它报告取消任务的请求已成功。</p>
<p>然后它会休眠一会儿，以允许任务响应要取消的请求。</p>
<p><strong>task_coroutine()</strong> 恢复并引发 <strong>CancelledError</strong> 异常，导致任务失败并完成。</p>
<p><strong>main()</strong> 协程恢复并报告任务是否处于已取消状态。 在这种情况下，确实如此。</p>
<p>此示例重点介绍了取消正在运行的任务的正常情况。</p>
<div class="language-text highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>main coroutine started
executing the task
was canceled: True
canceled: True
main coroutine done
</code></pre></div>
</div>
<div class="tabbed-block">
<p>We can cancel a task via the <strong>cancel()</strong> method on an <a href="https://docs.python.org/3/library/asyncio-task.html#asyncio.Task.cancel">asyncio.Task</a> object.</p>
<p>The <strong>cancel()</strong> method returns True if the task was canceled, or False otherwise.</p>
<p>For example:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># cancel the task</span>
was_cancelled <span style="color: #666666">=</span> task<span style="color: #666666">.</span>cancel()
</code></pre></div>
<p>If the task is already done, it cannot be canceled and the cancel() method will return False and the task will not have the status of canceled.</p>
<p>The next time the task is given an opportunity to run, it will raise a CancelledError exception.</p>
<p>If the CancelledError exception is not handled within the wrapped coroutine, the task will be canceled.</p>
<p>Otherwise, if the CancelledError exception is handled within the wrapped coroutine, the task will not be canceled.</p>
<p>The cancel() method can also take a message argument which will be used in the content of the CancelledError.</p>
<p>We can explore how to cancel a running task.</p>
<p>In this example, we define a task coroutine that reports a message and then blocks for a moment.</p>
<p>We then define the main coroutine that is used as the entry point into the asyncio program. It reports a message, creates and schedules the task, then waits a moment.</p>
<p>The main coroutine then resumes and cancels the task while it is running. It waits a moment more to allow the task to respond to the request to cancel. The main coroutine then reports whether the request to cancel the task was successful.</p>
<p>The task is canceled and is then done.</p>
<p>The main coroutine then reports whether the status of the task is canceled before closing the program.</p>
<p>The complete example is listed below.</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #3D7B7B; font-style: italic"># SuperFastPython.com</span>
<span style="color: #3D7B7B; font-style: italic"># example of canceling a running task</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">asyncio</span>

<span style="color: #3D7B7B; font-style: italic"># define a coroutine for a task</span>
<span style="color: #008000; font-weight: bold">async</span> <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">task_coroutine</span>():
    <span style="color: #3D7B7B; font-style: italic"># report a message</span>
    <span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;executing the task&#39;</span>)
    <span style="color: #3D7B7B; font-style: italic"># block for a moment</span>
    <span style="color: #008000; font-weight: bold">await</span> asyncio<span style="color: #666666">.</span>sleep(<span style="color: #666666">1</span>)

<span style="color: #3D7B7B; font-style: italic"># custom coroutine</span>
<span style="color: #008000; font-weight: bold">async</span> <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">main</span>():
    <span style="color: #3D7B7B; font-style: italic"># report a message</span>
    <span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;main coroutine started&#39;</span>)
    <span style="color: #3D7B7B; font-style: italic"># create and schedule the task</span>
    task <span style="color: #666666">=</span> asyncio<span style="color: #666666">.</span>create_task(task_coroutine())
    <span style="color: #3D7B7B; font-style: italic"># wait a moment</span>
    <span style="color: #008000; font-weight: bold">await</span> asyncio<span style="color: #666666">.</span>sleep(<span style="color: #666666">0.1</span>)
    <span style="color: #3D7B7B; font-style: italic"># cancel the task</span>
    was_cancelled <span style="color: #666666">=</span> task<span style="color: #666666">.</span>cancel()
    <span style="color: #3D7B7B; font-style: italic"># report whether the cancel request was successful</span>
    <span style="color: #008000">print</span>(<span style="color: #BA2121">f&#39;was canceled: </span><span style="color: #A45A77; font-weight: bold">{</span>was_cancelled<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&#39;</span>)
    <span style="color: #3D7B7B; font-style: italic"># wait a moment</span>
    <span style="color: #008000; font-weight: bold">await</span> asyncio<span style="color: #666666">.</span>sleep(<span style="color: #666666">0.1</span>)
    <span style="color: #3D7B7B; font-style: italic"># check the status of the task</span>
    <span style="color: #008000">print</span>(<span style="color: #BA2121">f&#39;canceled: </span><span style="color: #A45A77; font-weight: bold">{</span>task<span style="color: #666666">.</span>cancelled()<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&#39;</span>)
    <span style="color: #3D7B7B; font-style: italic"># report a final message</span>
    <span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;main coroutine done&#39;</span>)

<span style="color: #3D7B7B; font-style: italic"># start the asyncio program</span>
asyncio<span style="color: #666666">.</span>run(main())
</code></pre></div>
<p>Running the example starts the asyncio event loop and executes the <strong>main()</strong> coroutine.</p>
<p>The <strong>main()</strong> coroutine reports a message, then creates and schedules the task coroutine.</p>
<p>It then suspends and awaits a moment to allow the task coroutine to begin running.</p>
<p>The task runs, reports a message and sleeps for a while.</p>
<p>The <strong>main()</strong> coroutine resumes and cancels the task. It reports that the request to cancel the task was successful.</p>
<p>It then sleeps for a moment to allow the task to respond to the request to be canceled.</p>
<p>The <strong>task_coroutine()</strong> resumes and a <strong>CancelledError</strong> exception is raised that causes the task to fail and be done.</p>
<p>The <strong>main()</strong> coroutine resumes and reports whether the task has the status of canceled. In this case, it does.</p>
<p>This example highlights the normal case of canceling a running task.</p>
<div class="language-text highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>main coroutine started
executing the task
was canceled: True
canceled: True
main coroutine done
</code></pre></div>
</div>
</div>
</div>
<h2 id="242-如何等待任务完成">24.2 如何等待任务完成？<a class="headerlink" href="#242-如何等待任务完成" title="Permanent link">&para;</a></h2>
<p><strong>24.2 How to Wait for a Task To Finish?</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">中文</label><label for="__tabbed_3_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>我们可以通过直接等待 <strong>asyncio.Task</strong> 对象来等待任务完成。</p>
<p>例如:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># 等待任务完成</span>
<span style="color: #008000; font-weight: bold">await</span> task
</code></pre></div>
<p>我们可以在一行中创建并等待任务完成。</p>
<p>例如:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># 创建并等待任务完成</span>
<span style="color: #008000; font-weight: bold">await</span> asyncio<span style="color: #666666">.</span>create_task(custom_coro())
</code></pre></div>
</div>
<div class="tabbed-block">
<p>We can wait for a task to finish by awaiting the <strong>asyncio.Task</strong> object directly.</p>
<p>For example:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># wait for the task to finish</span>
<span style="color: #008000; font-weight: bold">await</span> task
</code></pre></div>
<p>We may create and wait for the task in a single line.</p>
<p>For example:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># create and wait for the task to finish</span>
<span style="color: #008000; font-weight: bold">await</span> asyncio<span style="color: #666666">.</span>create_task(custom_coro())
</code></pre></div>
</div>
</div>
</div>
<h2 id="243-如何获取任务的返回值">24.3 如何获取任务的返回值？<a class="headerlink" href="#243-如何获取任务的返回值" title="Permanent link">&para;</a></h2>
<p><strong>24.3 How to Get a Return Value from a Task?</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">中文</label><label for="__tabbed_4_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>我们可能需要将值从协程返回给调用者。</p>
<p>我们可以通过等待协程来检索返回值。</p>
<p>它假设正在等待的另一个协程返回一个值。</p>
<p>例如:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #3D7B7B; font-style: italic"># 有返回值的协程</span>
<span style="color: #008000; font-weight: bold">async</span> <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">other_coro</span>():
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">100</span>
</code></pre></div>
<p>等待另一个协程将挂起<strong>调用协程</strong>并安排另一个协程执行。 一旦其他协程完成，调用协程将恢复。 返回值将从另一个协程传递给调用者。</p>
<p>例如:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># 执行协程并获取返回值</span>
value <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">await</span> other_coro()
</code></pre></div>
<p>协程可以包装在 <strong>asyncio.Task</strong> 对象中。</p>
<p><strong>这对于独立执行协程很有帮助，而无需当前协程等待它。</strong></p>
<p>这可以使用 <a href="https://docs.python.org/3/library/asyncio-task.html#asyncio.create_task">asyncio.create_task()</a> 函数来实现。</p>
<p>例如:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># 将协程包装在任务中并安排其执行</span>
task <span style="color: #666666">=</span> asyncio<span style="color: #666666">.</span>create_task(other_coro())
</code></pre></div>
<p>您可以在教程中了解有关如何创建任务的更多信息：</p>
<ul>
<li><a href="https://superfastpython.com/asyncio-create-task">在Python中如何创建一个Asyncio任务</a></li>
</ul>
<p>有两种方法可以从 <strong>asyncio.Task</strong> 中检索返回值，它们是：</p>
<ol>
<li>等待任务.</li>
<li>调用 <strong>result()</strong> 方法.</li>
</ol>
<p>我们可以等待任务来检索返回值。</p>
<p>如果任务已调度或正在运行，则调用者将挂起，直到任务完成并提供返回值。</p>
<p>如果任务完成，将立即提供返回值。</p>
<p>例如:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># 获取任务的返回值</span>
value <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">await</span> task
</code></pre></div>
<p>与协程不同，我们可以多次等待任务而不会引发错误。</p>
<p>例如:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># 获取任务的返回值</span>
value <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">await</span> task
<span style="color: #3D7B7B; font-style: italic"># 获取任务的返回值</span>
value <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">await</span> task
</code></pre></div>
<p>我们还可以通过调用 <strong>asyncio.Task</strong> 对象上的 <a href="https://docs.python.org/3/library/asyncio-task.html#asyncio.Task.result">result()</a> 方法来获取任务的返回值。</p>
<p>例如:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># 获取任务的返回值</span>
value <span style="color: #666666">=</span> task<span style="color: #666666">.</span>result()
</code></pre></div>
<p>这就要求任务完成。 如果不是，将引发 <strong>InvalidStateError</strong> 异常。</p>
<p>如果任务被取消，则会引发 <strong>CancelledError</strong> 异常。</p>
<p>您可以了解有关从教程中的任务获取结果的更多信息：</p>
<ul>
<li><a href="https://superfastpython.com/asyncio-task-result">如何获取 Asyncio 任务结果</a></li>
</ul>
</div>
<div class="tabbed-block">
<p>We may need to return values from coroutines to the caller.</p>
<p>We can retrieve a return value from a coroutine by awaiting it.</p>
<p>It assumes that the other coroutine being awaited returns a value.</p>
<p>For example:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #3D7B7B; font-style: italic"># coroutine that returns a value</span>
<span style="color: #008000; font-weight: bold">async</span> <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">other_coro</span>():
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">100</span>
</code></pre></div>
<p>Awaiting the other coroutine will suspend the calling coroutine and schedule the other coroutine for execution. Once the other coroutine has been completed, the calling coroutine will resume. The return value will be passed from the other coroutine to the caller.</p>
<p>For example:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># execute coroutine and retrieve return value</span>
value <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">await</span> other_coro()
</code></pre></div>
<p>A coroutine can be wrapped in an <strong>asyncio.Task</strong> object.</p>
<p>This is helpful for independently executing the coroutine without having the current coroutine await it.</p>
<p>This can be achieved using the <a href="https://docs.python.org/3/library/asyncio-task.html#asyncio.create_task">asyncio.create_task()</a> function.</p>
<p>For example:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># wrap coroutine in a task and schedule it for execution</span>
task <span style="color: #666666">=</span> asyncio<span style="color: #666666">.</span>create_task(other_coro())
</code></pre></div>
<p>You can learn more about how to create tasks in the tutorial:</p>
<ul>
<li><a href="https://superfastpython.com/asyncio-create-task">How to Create an Asyncio Task in Python</a></li>
</ul>
<p>There are two ways to retrieve the return value from an asyncio.Task, they are:</p>
<ol>
<li>Await the task.</li>
<li>Call the result() method.</li>
</ol>
<p>We can await the task to retrieve the return value.</p>
<p>If the task is scheduled or running, then the caller will suspend until the task is complete and the return value will be provided.</p>
<p>If the task is completed, the return value will be provided immediately.</p>
<p>For example:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># get the return value from a task</span>
value <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">await</span> task
</code></pre></div>
<p>Unlike a coroutine, we can await a task more than once without raising an error.</p>
<p>For example:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># get the return value from a task</span>
value <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">await</span> task
<span style="color: #3D7B7B; font-style: italic"># get the return value from a task</span>
value <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">await</span> task
</code></pre></div>
<p>We can also get the return value from the task by calling the <a href="https://docs.python.org/3/library/asyncio-task.html#asyncio.Task.result">result()</a> method on the <strong>asyncio.Task</strong> object.</p>
<p>For example:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># get the return value from a task</span>
value <span style="color: #666666">=</span> task<span style="color: #666666">.</span>result()
</code></pre></div>
<p>This requires that the task is done. If not, an <strong>InvalidStateError</strong> exception will be raised.</p>
<p>If the task was canceled a <strong>CancelledError</strong> exception will be raised.</p>
<p>You can learn more about getting the result from tasks in the tutorial:</p>
<ul>
<li><a href="https://superfastpython.com/asyncio-task-result">How to Get Asyncio Task Results</a></li>
</ul>
</div>
</div>
</div>
<h2 id="244-如何在后台运行任务">24.4 如何在后台运行任务？<a class="headerlink" href="#244-如何在后台运行任务" title="Permanent link">&para;</a></h2>
<p><strong>24.4 How to Run a Task in the Background?</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">中文</label><label for="__tabbed_5_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>我们可以通过将协程包装在 <strong>asyncio.Task</strong> 对象中来在后台运行协程。</p>
<p>这可以通过调用 <strong>asyncio.create_task()</strong> 函数并向其传递协程来实现。</p>
<p>协程将被包装在 Task 对象中并被安排执行。 任务对象将被返回，并且调用者不会挂起。</p>
<p>例如:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># 调度任务执行</span>
task <span style="color: #666666">=</span> asyncio<span style="color: #666666">.</span>create_task(other_coroutine())
</code></pre></div>
<p>至少在当前协程出于任何原因被挂起之前，该任务不会开始执行。</p>
<p>我们可以通过暂停片刻以允许任务开始运行来帮助完成任务。</p>
<p>这可以通过休眠零秒来实现。</p>
<p>例如:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># 暂停片刻以允许任务开始运行</span>
<span style="color: #008000; font-weight: bold">await</span> asyncio<span style="color: #666666">.</span>sleep(<span style="color: #666666">0</span>)
</code></pre></div>
<p>这只会将调用者暂停一小会儿，并允许有机会运行。</p>
<p>这不是必需的，因为调用者可能会在将来的某个时间挂起或作为正常执行的一部分终止。</p>
<p>一旦调用者没有事情可做，我们也可以直接等待任务。</p>
<p>例如:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># 等待任务完成</span>
<span style="color: #008000; font-weight: bold">await</span> task
</code></pre></div>
</div>
<div class="tabbed-block">
<p>We can run a coroutine in the background by wrapping it in an <strong>asyncio.Task</strong> object.</p>
<p>This can be achieved by calling the <strong>asyncio.create_task()</strong> function and passing it the coroutine.</p>
<p>The coroutine will be wrapped in a Task object and will be scheduled for execution. The task object will be returned and the caller will not suspend.</p>
<p>For example:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># schedule the task for execution</span>
task <span style="color: #666666">=</span> asyncio<span style="color: #666666">.</span>create_task(other_coroutine())
</code></pre></div>
<p>The task will not begin executing until at least the current coroutine is suspended, for any reason.</p>
<p>We can help things along by suspending for a moment to allow the task to start running.</p>
<p>This can be achieved by sleeping for zero seconds.</p>
<p>For example:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># suspend for a moment to allow the task to start running</span>
<span style="color: #008000; font-weight: bold">await</span> asyncio<span style="color: #666666">.</span>sleep(<span style="color: #666666">0</span>)
</code></pre></div>
<p>This will suspend the caller only for a brief moment and allow the ask an opportunity to run.</p>
<p>This is not required as the caller may suspend at some future time or terminate as part of normal execution.</p>
<p>We may also await the task directly once the caller has run out of things to do.</p>
<p>For example:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># wait for the task to complete</span>
<span style="color: #008000; font-weight: bold">await</span> task
</code></pre></div>
</div>
</div>
</div>
<h2 id="245-如何等待所有后台任务">24.5 如何等待所有后台任务？<a class="headerlink" href="#245-如何等待所有后台任务" title="Permanent link">&para;</a></h2>
<p><strong>24.5 How to Wait for All Background Tasks?</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">中文</label><label for="__tabbed_6_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>我们可以等待 asyncio 程序中的所有独立任务。</p>
<p>首先可以通过 <strong>asyncio.all_tasks()</strong> 函数获取一组所有当前正在运行的任务来实现。</p>
<p>例如:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># 获取所有正在运行的任务的集合</span>
all_tasks <span style="color: #666666">=</span> asyncio<span style="color: #666666">.</span>all_tasks()
</code></pre></div>
<p>这将返回一个集合，其中包含当前正在运行的每个任务的一个 <strong>asyncio.Task</strong> 对象，包括 <strong>main()</strong> 协程。</p>
<p>我们不能直接等待这个集合，因为它会永远阻塞，因为它包含当前任务的任务。</p>
<p>因此，我们可以获取当前正在运行的任务的 <strong>asyncio.Task</strong> 对象并将其从集合中删除。</p>
<p>这首先可以通过调用 <strong>asyncio.current_task()</strong> 方法来获取当前协程的任务，然后通过 <strong>remove()</strong> 方法将其从集合中删除来实现。</p>
<p>例如:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># 获取当前任务</span>
current_task <span style="color: #666666">=</span> asyncio<span style="color: #666666">.</span>current_task()
<span style="color: #3D7B7B; font-style: italic"># 从所有任务列表中删除当前任务</span>
all_tasks<span style="color: #666666">.</span>remove(current_task)
</code></pre></div>
<p>最后，我们可以等待剩余的任务集。</p>
<p>这将挂起调用者，直到该组中的所有任务完成。</p>
<p>例如:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># 挂起直到所有任务完成</span>
<span style="color: #008000; font-weight: bold">await</span> asyncio<span style="color: #666666">.</span>wait(all_tasks)
</code></pre></div>
<p>将它们结合在一起，添加到 <strong>main()</strong> 协程末尾的下面的代码片段将等待所有后台任务完成。</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># 获取所有正在运行的任务的集合</span>
all_tasks <span style="color: #666666">=</span> asyncio<span style="color: #666666">.</span>all_tasks()
<span style="color: #3D7B7B; font-style: italic"># 获取当前任务</span>
current_task <span style="color: #666666">=</span> asyncio<span style="color: #666666">.</span>current_task()
<span style="color: #3D7B7B; font-style: italic"># 从所有任务列表中删除当前任务</span>
all_tasks<span style="color: #666666">.</span>remove(current_task)
<span style="color: #3D7B7B; font-style: italic"># 挂起直到所有任务完成</span>
<span style="color: #008000; font-weight: bold">await</span> asyncio<span style="color: #666666">.</span>wait(all_tasks)
</code></pre></div>
</div>
<div class="tabbed-block">
<p>We can wait for all independent tasks in an asyncio program.</p>
<p>This can be achieved by first getting a set of all currently running tasks via the <strong>asyncio.all_tasks()</strong> function.</p>
<p>For example:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># get a set of all running tasks</span>
all_tasks <span style="color: #666666">=</span> asyncio<span style="color: #666666">.</span>all_tasks()
</code></pre></div>
<p>This will return a set that contains one <strong>asyncio.Task</strong> object for each task that is currently running, including the <strong>main()</strong> coroutine.</p>
<p>We cannot wait on this set directly, as it will block forever as it includes the task that is the current task.</p>
<p>Therefore we can get the <strong>asyncio.Task</strong> object for the currently running task and remove it from the set.</p>
<p>This can be achieved by first calling the <strong>asyncio.current_task()</strong> method to get the task for the current coroutine and then remove it from the set via the <strong>remove()</strong> method.</p>
<p>For example:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># get the current tasks</span>
current_task <span style="color: #666666">=</span> asyncio<span style="color: #666666">.</span>current_task()
<span style="color: #3D7B7B; font-style: italic"># remove the current task from the list of all tasks</span>
all_tasks<span style="color: #666666">.</span>remove(current_task)
</code></pre></div>
<p>Finally, we can wait on the set of remaining tasks.</p>
<p>This will suspend the caller until all tasks in the set are complete.</p>
<p>For example:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># suspend until all tasks are completed</span>
<span style="color: #008000; font-weight: bold">await</span> asyncio<span style="color: #666666">.</span>wait(all_tasks)
</code></pre></div>
<p>Tying this together, the snippet below added to the end of the <strong>main()</strong> coroutine will wait for all background tasks to complete.</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># get a set of all running tasks</span>
all_tasks <span style="color: #666666">=</span> asyncio<span style="color: #666666">.</span>all_tasks()
<span style="color: #3D7B7B; font-style: italic"># get the current tasks</span>
current_task <span style="color: #666666">=</span> asyncio<span style="color: #666666">.</span>current_task()
<span style="color: #3D7B7B; font-style: italic"># remove the current task from the list of all tasks</span>
all_tasks<span style="color: #666666">.</span>remove(current_task)
<span style="color: #3D7B7B; font-style: italic"># suspend until all tasks are completed</span>
<span style="color: #008000; font-weight: bold">await</span> asyncio<span style="color: #666666">.</span>wait(all_tasks)
</code></pre></div>
</div>
</div>
</div>
<h2 id="246-正在运行的任务是否会阻止事件循环退出">24.6 正在运行的任务是否会阻止事件循环退出？<a class="headerlink" href="#246-正在运行的任务是否会阻止事件循环退出" title="Permanent link">&para;</a></h2>
<p><strong>24.6 Does a Running Task Stop the Event Loop from Exiting?</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">中文</label><label for="__tabbed_7_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>不。</p>
<p>独立调度和运行的任务不会阻止事件循环退出。</p>
<p>如果您的主协程没有其他活动需要完成，并且有独立任务在后台运行，您应该检索正在运行的任务并等待它们</p>
<p>上一个问题/答案准确地展示了如何做到这一点。</p>
</div>
<div class="tabbed-block">
<p>No.</p>
<p>A task that is scheduled and run independently will not stop the event loop from exiting.</p>
<p>If your main coroutine has no other activities to complete and there are independent tasks running in the background, you should retrieve the running tasks and wait on them</p>
<p>The previous question/answer shows exactly how to do this.</p>
</div>
</div>
</div>
<h2 id="247-如何显示运行任务的进度">24.7 如何显示运行任务的进度？<a class="headerlink" href="#247-如何显示运行任务的进度" title="Permanent link">&para;</a></h2>
<p><strong>24.7 How to Show Progress of Running Tasks?</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:2"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><input id="__tabbed_8_2" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">中文</label><label for="__tabbed_8_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>我们可以使用每个任务的回调函数来显示进度。</p>
<p>执行完成后的回调函数是我们可以在 <strong>asyncio.Task</strong> 上注册的函数。</p>
<p>一旦任务执行完，无论正常还是失败，都会调用它。</p>
<p>done 回调函数是一个常规函数，而不是协程，并且将与其关联的 <strong>asyncio.Task</strong> 作为参数。</p>
<p>我们可以对所有任务使用相同的回调函数，并以通用方式报告进度，例如报告消息。</p>
<p>例如:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #3D7B7B; font-style: italic"># 回调函数显示任务进度</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">progress</span>(task):
    <span style="color: #3D7B7B; font-style: italic"># 报告任务进度</span>
    <span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;.&#39;</span>, end<span style="color: #666666">=</span><span style="color: #BA2121">&#39;&#39;</span>)
</code></pre></div>
<p>我们可以在我们发出的每个 <strong>asyncio.Task</strong> 上注册一个回调函数。</p>
<p>这可以通过在每个任务上使用 <a href="https://docs.python.org/3/library/asyncio-task.html#asyncio.Task.add_done_callback">add_done_callback()</a> 方法并向其传递回调函数的名称来实现。</p>
<p>例如:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># 向任务添加回调函数</span>
task<span style="color: #666666">.</span>add_done_callback(progress)
</code></pre></div>
</div>
<div class="tabbed-block">
<p>We can show progress using a done callback function on each task.</p>
<p>A done callback is a function that we can register on an <strong>asyncio.Task</strong>.</p>
<p>It is called once the task is done, either normally or if it fails.</p>
<p>The done callback function is a regular function, not a coroutine, and takes the <strong>asyncio.Task</strong> that it is associated with as an argument.</p>
<p>We can use the same callback function for all tasks and report progress in a general way, such as by reporting a message.</p>
<p>For example:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #3D7B7B; font-style: italic"># callback function to show progress of tasks</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">progress</span>(task):
    <span style="color: #3D7B7B; font-style: italic"># report progress of the task</span>
    <span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;.&#39;</span>, end<span style="color: #666666">=</span><span style="color: #BA2121">&#39;&#39;</span>)
</code></pre></div>
<p>We can register a callback function on each <strong>asyncio.Task</strong> that we issue.</p>
<p>This can be achieved using the <a href="https://docs.python.org/3/library/asyncio-task.html#asyncio.Task.add_done_callback">add_done_callback()</a> method on each task and passing it the name of the callback function.</p>
<p>For example:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># add a done callback to a task</span>
task<span style="color: #666666">.</span>add_done_callback(progress)
</code></pre></div>
</div>
</div>
</div>
<h2 id="248-如何在延迟后运行任务">24.8 如何在延迟后运行任务？<a class="headerlink" href="#248-如何在延迟后运行任务" title="Permanent link">&para;</a></h2>
<p><strong>24.8 How to Run a Task After a Delay?</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="9:2"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><input id="__tabbed_9_2" name="__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="__tabbed_9_1">中文</label><label for="__tabbed_9_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>我们可以开发一个自定义包装协程来在延迟后执行目标协程。</p>
<p>包装协程可以采用两个参数，一个协程和一个以秒为单位的时间。</p>
<p>它将休眠给定的延迟间隔（以秒为单位），然后等待提供的协程执行完毕。</p>
<p>下面的 <strong>delay()</strong> 协程实现了这一点。</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #3D7B7B; font-style: italic"># 延迟几秒后启动另一个协程的协程</span>
<span style="color: #008000; font-weight: bold">async</span> <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">delay</span>(coro, seconds):
    <span style="color: #3D7B7B; font-style: italic"># 暂停时间限制（以秒为单位）</span>
    <span style="color: #008000; font-weight: bold">await</span> asyncio<span style="color: #666666">.</span>sleep(seconds)
    <span style="color: #3D7B7B; font-style: italic"># 执行另一个协程</span>
    <span style="color: #008000; font-weight: bold">await</span> coro
</code></pre></div>
<p>要使用包装协程，可以创建协程对象并直接等待或作为任务独立执行。</p>
<p>例如，调用者可以挂起并调度延迟协程并等待其完成：</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># 延迟后执行协程</span>
<span style="color: #008000; font-weight: bold">await</span> delay(coro, <span style="color: #666666">10</span>)
</code></pre></div>
<p>或者，调用者可以安排延迟协程独立运行：</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># 在延迟后独立执行协程</span>
_ <span style="color: #666666">=</span> asyncio<span style="color: #666666">.</span>create_task(delay(coro, <span style="color: #666666">10</span>))
</code></pre></div>
</div>
<div class="tabbed-block">
<p>We can develop a custom wrapper coroutine to execute a target coroutine after a delay.</p>
<p>The wrapper coroutine may take two arguments, a coroutine and a time in seconds.</p>
<p>It will sleep for the given delay interval in seconds, then await the provided coroutine.</p>
<p>The <strong>delay()</strong> coroutine below implements this.</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #3D7B7B; font-style: italic"># coroutine that will start another coroutine after a delay in seconds</span>
<span style="color: #008000; font-weight: bold">async</span> <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">delay</span>(coro, seconds):
    <span style="color: #3D7B7B; font-style: italic"># suspend for a time limit in seconds</span>
    <span style="color: #008000; font-weight: bold">await</span> asyncio<span style="color: #666666">.</span>sleep(seconds)
    <span style="color: #3D7B7B; font-style: italic"># execute the other coroutine</span>
    <span style="color: #008000; font-weight: bold">await</span> coro
</code></pre></div>
<p>To use the wrapper coroutine, a coroutine object can be created and either awaited directly or executed independently as a task.</p>
<p>For example, the caller may suspend and schedule the delayed coroutine and wait for it to be done:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># execute a coroutine after a delay</span>
<span style="color: #008000; font-weight: bold">await</span> delay(coro, <span style="color: #666666">10</span>)
</code></pre></div>
<p>Alternatively, the caller may schedule the delayed coroutine to run independently:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># execute a coroutine after a delay independently</span>
_ <span style="color: #666666">=</span> asyncio<span style="color: #666666">.</span>create_task(delay(coro, <span style="color: #666666">10</span>))
</code></pre></div>
</div>
</div>
</div>
<h2 id="249-如何运行后续任务">24.9 如何运行后续任务？<a class="headerlink" href="#249-如何运行后续任务" title="Permanent link">&para;</a></h2>
<p><strong>24.9 How to Run a Follow-Up Task?</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="10:2"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio" /><input id="__tabbed_10_2" name="__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="__tabbed_10_1">中文</label><label for="__tabbed_10_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><strong>asyncio</strong> 中发出<strong>后续任务</strong>(follow-up tasks)的方式主要有三种。</p>
<p>他们是:</p>
<ol>
<li>从已完成的任务本身调度后续任务。</li>
<li>从调用者调度后续任务。</li>
<li>使用回调函数自动调度后续任务。</li>
</ol>
<p>让我们仔细看看每种方法。</p>
<p>完成的任务可以发出自己的后续任务。</p>
<p>这可能需要检查某些状态以确定是否应该发出后续任务。</p>
<p>然后可以通过调用 <code>asyncio.create_task()</code> 来安排任务 .</p>
<p>例如:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># schedule a follow-up task</span>
task <span style="color: #666666">=</span> asyncio<span style="color: #666666">.</span>create_task(followup_task())
</code></pre></div>
<p>任务本身可以<strong>选择等待</strong>后续任务或让它在后台独立完成。</p>
<p>例如:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># 等待后续任务执行完毕</span>
<span style="color: #008000; font-weight: bold">await</span> task
</code></pre></div>
<p>下发任务的调用者可以选择下发后续任务。</p>
<p>例如，当调用者发出第一个任务时，它可能会保留 <code>asyncio.Task</code> 对象。</p>
<p>然后它可以检查任务的结果或任务是否成功完成。</p>
<p>然后调用者可以决定是否发出后续任务。</p>
<p>它也可以直接选择等待/不等待后续任务执行完毕。</p>
<p>例如:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># 发出并等待第一个任务</span>
task <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">await</span> asyncio<span style="color: #666666">.</span>create_task(task())
<span style="color: #3D7B7B; font-style: italic"># 检查任务结果</span>
<span style="color: #008000; font-weight: bold">if</span> task<span style="color: #666666">.</span>result():
    <span style="color: #3D7B7B; font-style: italic"># 下达后续任务</span>
    followup <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">await</span> asyncio<span style="color: #666666">.</span>create_task(followup_task())
</code></pre></div>
<p>我们可以使用回调函数自动执行后续任务。</p>
<p>例如，发出任务的调用者可以在任务本身上注册执行完成后的回调函数。</p>
<p>回调函数必须将 <code>asyncio.Task</code> 对象作为参数，并且只有在任务完成后才会被调用。 然后它可以选择是否发出后续任务。</p>
<p>回调函数是一个常规的Python函数，而不是协程，因此它不能等待后续任务</p>
<p>例如，回调函数可能如下所示：</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #3D7B7B; font-style: italic"># 回调函数</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">callback</span>(task):
    <span style="color: #3D7B7B; font-style: italic"># 调度并等待后续任务</span>
    _ <span style="color: #666666">=</span> asyncio<span style="color: #666666">.</span>create_task(followup())
</code></pre></div>
<p>调用者可以发出第一个任务并注册执行完成后的回调函数。</p>
<p>例如:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># 调度任务</span>
task <span style="color: #666666">=</span> asyncio<span style="color: #666666">.</span>create_task(work())
<span style="color: #3D7B7B; font-style: italic"># 添加执行完后的回调函数</span>
task<span style="color: #666666">.</span>add_done_callback(callback)
</code></pre></div>
</div>
<div class="tabbed-block">
<p>There are three main ways to issue follow-up tasks in asyncio.</p>
<p>They are:</p>
<ol>
<li>Schedule the follow-up task from the completed task itself.</li>
<li>Schedule the follow-up task from the caller.</li>
<li>Schedule the follow-up task automatically using a done callback.</li>
</ol>
<p>Let’s take a closer look at each approach.</p>
<p>The task that is completed can issue its own follow-up task.</p>
<p>This may require checking some state in order to determine whether the follow-up task should be issued or not.</p>
<p>The task can then be scheduled via a call to <code>asyncio.create_task()</code>.</p>
<p>For example:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># schedule a follow-up task</span>
task <span style="color: #666666">=</span> asyncio<span style="color: #666666">.</span>create_task(followup_task())
</code></pre></div>
<p>The task itself may choose to await the follow-up task or let it complete in the background independently.</p>
<p>For example:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># wait for the follow-up task to complete</span>
<span style="color: #008000; font-weight: bold">await</span> task
</code></pre></div>
<p>The caller that issued the task can choose to issue a follow-up task.</p>
<p>For example, when the caller issues the first task, it may keep the asyncio.Task object.</p>
<p>It can then check the result of the task or whether the task was completed successfully or not.</p>
<p>The caller can then decide to issue a follow-up task.</p>
<p>It may or may not await the follow-up task directly.</p>
<p>For example:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># issue and await the first task</span>
task <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">await</span> asyncio<span style="color: #666666">.</span>create_task(task())
<span style="color: #3D7B7B; font-style: italic"># check the result of the task</span>
<span style="color: #008000; font-weight: bold">if</span> task<span style="color: #666666">.</span>result():
    <span style="color: #3D7B7B; font-style: italic"># issue the follow-up task</span>
    followup <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">await</span> asyncio<span style="color: #666666">.</span>create_task(followup_task())
</code></pre></div>
<p>We can execute a follow-up task automatically using a done callback function.</p>
<p>For example, the caller that issues the task can register a done callback function on the task itself.</p>
<p>The done callback function must take the asyncio.Task object as an argument and will be called only after the task is done. It can then choose to issue a follow-up task.</p>
<p>The done callback function is a regular Python function, not a coroutine, so it cannot await the follow-up task</p>
<p>For example, the callback function may look as follows:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #3D7B7B; font-style: italic"># callback function</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">callback</span>(task):
    <span style="color: #3D7B7B; font-style: italic"># schedule and await the follow-up task</span>
    _ <span style="color: #666666">=</span> asyncio<span style="color: #666666">.</span>create_task(followup())
</code></pre></div>
<p>The caller can issue the first task and register the done callback function.</p>
<p>For example:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># schedule and the task</span>
task <span style="color: #666666">=</span> asyncio<span style="color: #666666">.</span>create_task(work())
<span style="color: #3D7B7B; font-style: italic"># add the done callback function</span>
task<span style="color: #666666">.</span>add_done_callback(callback)
</code></pre></div>
</div>
</div>
</div>
<h2 id="2410-如何在-asyncio-中执行阻塞-io-或-cpu-密集型函数">24.10 如何在 Asyncio 中执行阻塞 I/O 或 CPU 密集型函数？<a class="headerlink" href="#2410-如何在-asyncio-中执行阻塞-io-或-cpu-密集型函数" title="Permanent link">&para;</a></h2>
<p><strong>24.10 How to Execute a Blocking I/O or CPU-bound Function in Asyncio?</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="11:2"><input checked="checked" id="__tabbed_11_1" name="__tabbed_11" type="radio" /><input id="__tabbed_11_2" name="__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="__tabbed_11_1">中文</label><label for="__tabbed_11_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>asyncio 模块提供了两种在 asyncio 程序中执行阻塞调用的方法。</p>
<p>第一种是使用 <a href="https://docs.python.org/3/library/asyncio-task.html#asyncio.to_thread">asyncio.to_thread()</a> 函数。</p>
<p>这是高级 API 中的内容，适用于应用程序开发人员。</p>
<p><code>asyncio.to_thread()</code> 函数接受要执行的函数名称和任何参数。</p>
<p>该函数在单独的线程中执行。 它返回一个可以作为独立任务等待或调度的协程。</p>
<p>例如：</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># 在单独的线程中执行函数</span>
<span style="color: #008000; font-weight: bold">await</span> asyncio<span style="color: #666666">.</span>to_thread(task)
</code></pre></div>
<p>任务一开始并不会执行。直到协程返回并且给个在事件循环中运行的机会时，才会运行。</p>
<p><code>asyncio.to_thread()</code> 函数在后台创建一个 <strong>ThreadPoolExecutor</strong> 来执行阻塞调用。</p>
<p>因此，<code>asyncio.to_thread()</code> 函数仅适用于 IO 密集型任务。</p>
<p>另一种方法是使用<a href="https://docs.python.org/3/library/asyncio-eventloop.html#asyncio.loop.run_in_executor">loop.run_in_executor()</a>函数。</p>
<p>这是在低级 asyncio API 中，首先需要访问事件循环，例如通过 <a href="https://docs.python.org/3/library/asyncio-eventloop.html#asyncio.get_running_loop">asyncio.get_running_loop()</a> 函数。</p>
<p><code>Loop.run_in_executor()</code> 函数需要一个执行器和一个要执行的函数。</p>
<p>如果没有为执行器提供参数，则默认值为 None，将使用默认执行器，即 <strong>ThreadPoolExecutor</strong>。</p>
<p><code>Loop.run_in_executor()</code> 函数返回一个可等待的对象，如果需要可以等待。 该任务将立即开始执行，因此不需要等待或安排返回的可等待对象来开始执行阻塞调用。</p>
<p>例如：</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># 获取事件循环</span>
loop <span style="color: #666666">=</span> asyncio<span style="color: #666666">.</span>get_running_loop()
<span style="color: #3D7B7B; font-style: italic"># 在单独的线程中执行函数</span>
<span style="color: #008000; font-weight: bold">await</span> loop<span style="color: #666666">.</span>run_in_executor(<span style="color: #008000; font-weight: bold">None</span>, task)
</code></pre></div>
<p>或者，可以创建一个执行器并将其传递给<code>loop.run_in_executor()</code>函数，该函数将在执行器中执行异步调用。</p>
<p>在这种情况下，调用者必须管理执行器，在调用者完成后将其关闭。</p>
<p>例如:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># 创建一个进程池</span>
<span style="color: #008000; font-weight: bold">with</span> ProcessPoolExecutor <span style="color: #008000; font-weight: bold">as</span> exe:
    <span style="color: #3D7B7B; font-style: italic"># 获取事件循环</span>
    loop <span style="color: #666666">=</span> asyncio<span style="color: #666666">.</span>get_running_loop()
    <span style="color: #3D7B7B; font-style: italic"># 在单独的线程中执行函数</span>
    <span style="color: #3D7B7B; font-style: italic"># process pool is shutdown automatically...</span>
    <span style="color: #3D7B7B; font-style: italic"># 进程池自动关闭...</span>
</code></pre></div>
<p>这两种方法允许阻塞调用作为 asyncio 程序中的异步任务执行。</p>
</div>
<div class="tabbed-block">
<p>The asyncio module provides two approaches for executing blocking calls in asyncio programs.</p>
<p>The first is to use the <a href="https://docs.python.org/3/library/asyncio-task.html#asyncio.to_thread">asyncio.to_thread()</a> function.</p>
<p>This is in the high-level API and is intended for application developers.</p>
<p>The <a href="https://docs.python.org/3/library/asyncio-task.html#asyncio.to_thread">asyncio.to_thread()</a> function takes a function name to execute and any arguments.</p>
<p>The function is executed in a separate thread. It returns a coroutine that can be awaited or scheduled as an independent task.</p>
<p>For example:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># execute a function in a separate thread</span>
<span style="color: #008000; font-weight: bold">await</span> asyncio<span style="color: #666666">.</span>to_thread(task)
</code></pre></div>
<p>The task will not begin executing until the returned coroutine is given an opportunity to run in the event loop.</p>
<p>The asyncio.to_thread() function creates a <strong>ThreadPoolExecutor</strong> behind the scenes to execute blocking calls.</p>
<p>As such, the <code>asyncio.to_thread()</code> function is only appropriate for IO-bound tasks.</p>
<p>An alternative approach is to use the <a href="https://docs.python.org/3/library/asyncio-eventloop.html#asyncio.loop.run_in_executor">loop.run_in_executor()</a> function.</p>
<p>This is in the low-level asyncio API and first requires access to the event loop, such as via the <a href="https://docs.python.org/3/library/asyncio-eventloop.html#asyncio.get_running_loop">asyncio.get_running_loop()</a> function.</p>
<p>The <code>loop.run_in_executor()</code> function takes an executor and a function to execute.</p>
<p>If None is provided for the executor, then the default executor is used, which is a ThreadPoolExecutor.</p>
<p>The <code>loop.run_in_executor()</code> function returns an awaitable that can be awaited if needed. The task will begin executing immediately, so the returned awaitable does not need to be awaited or scheduled for the blocking call to start executing.</p>
<p>For example:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># get the event loop</span>
loop <span style="color: #666666">=</span> asyncio<span style="color: #666666">.</span>get_running_loop()
<span style="color: #3D7B7B; font-style: italic"># execute a function in a separate thread</span>
<span style="color: #008000; font-weight: bold">await</span> loop<span style="color: #666666">.</span>run_in_executor(<span style="color: #008000; font-weight: bold">None</span>, task)
</code></pre></div>
<p>Alternatively, an executor can be created and passed to the loop.run_in_executor() function, which will execute the asynchronous call in the executor.</p>
<p>The caller must manage the executor in this case, shutting it down once the caller is finished with it.</p>
<p>For example:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">...</span>
<span style="color: #3D7B7B; font-style: italic"># create a process pool</span>
<span style="color: #008000; font-weight: bold">with</span> ProcessPoolExecutor <span style="color: #008000; font-weight: bold">as</span> exe:
    <span style="color: #3D7B7B; font-style: italic"># get the event loop</span>
    loop <span style="color: #666666">=</span> asyncio<span style="color: #666666">.</span>get_running_loop()
    <span style="color: #3D7B7B; font-style: italic"># execute a function in a separate thread</span>
    <span style="color: #008000; font-weight: bold">await</span> loop<span style="color: #666666">.</span>run_in_executor(exe, task)
    <span style="color: #3D7B7B; font-style: italic"># process pool is shutdown automatically...</span>
</code></pre></div>
<p>These two approaches allow a blocking call to be executed as an asynchronous task in an asyncio program.</p>
</div>
</div>
</div>

  <hr>
<div class="md-source-file">
  <small>
    
      最后更新:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">2024年9月4日</span>
      
        <br>
        创建日期:
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">2024年9月4日</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["header.autohide", "navigation.top", "navigation.tabs", "navigation.tabs.sticky", "navigation.path", "content.tabs.link", "content.code.copy", "content.tooltips", "navigation.indexes", "navigation.prune", "navigation.instant"], "search": "../../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.94c44541.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>